import sqlite3

def fetch_data_as_dict(database_path, table_name, key_field, value_field):
    connection = sqlite3.connect(database_path)
    cursor = connection.cursor()
    try:
        query = f"SELECT {key_field}, {value_field} FROM {table_name}"
        cursor.execute(query)
        data_dict = {row[0]: str(row[1])+' грн' for row in cursor.fetchall()}
        return data_dict
    except sqlite3.Error as e:
        print(f"An error occurred: {e}")
        return {}
    finally:
        connection.close()

print(len(fetch_data_as_dict('db.sqlite3', 'content_plant', 'plant_name', 'price')))

prices = {
    'Троянда садова': 0.15, 
    'Яблуня червона': 0.4, 
    'Смородина чорна': 0.3, 
    'Тюльпан весняний': 0.1, 
    'Сосна карликова': 0.6, 
    'Барвінок зелений': 0.05, 
    'Лаванда лікарська': 0.05, 
    'Шавлія мускатна': 0.05, 
    'Лілія біла': 0.12, 
    'Ромашка садова': 0.02, 
    'Жасмин ароматний': 0.35, 
    'Гортензія рожевобуза': 0.25, 
    'Жоржина осіння': 0.2, 
    'Верес фіолетовий': 0.05, 
    'Бузок білий': 0.6, 
    'Гладіолус ранній': 0.08, 
    'Суниці лісові': 0.01, 
    'Малина червона': 0.15, 
    'Агрус зелений': 0.2, 
    'Глід червоний': 0.35, 
    'Сирень садова': 0.5, 
    'Трава газонна': 0.1, 
    'Райграс пасовищний': 0.08, 
    'Конюшина біла': 0.05, 
    'Півонія садова': 0.25, 
    'Нарцис жовтий': 0.1, 
    'Фіалка нічна': 0.02, 
    'Братки садові': 0.02, 
    'Калина червона': 0.4, 
    'Груша лісова': 0.7, 
    'Абрикос садовий': 0.8, 
    'Вишня кисла': 0.6, 
    'Слива садова': 0.7, 
    'Чорниця звичайна': 0.15, 
    'Груша декоративна': 0.9, 
    'Береза біла': 0.6, 
    'Тис ягідний': 0.5, 
    'Форзиція жовта': 0.3, 
    'Ялівець козацький': 0.4, 
    'Мох газонний': 0.02, 
    'Курильський чай': 0.2, 
    'Бузок махровий': 0.4, 
    'Орхідея садова': 0.02, 
    'Флокс садовий': 0.03, 
    'Жовтець садовий': 0.08, 
    'Зірка однорічна': 0.02, 
    'Лаванда полева': 0.05, 
    'Яблуня зелена': 0.5, 
    'Смородина біла': 0.3, 
    'Тюльпан літній': 0.12, 
    'Сосна висока': 0.8, 
    'Шавлія лікарська': 0.06, 
    'Лілія рожева': 0.13, 
    'Ромашка полева': 0.02, 
    'Жасмин пізній': 0.35, 
    'Гортензія блакитна': 0.25, 
    'Жоржина весняна': 0.2, 
    'Верес осінній': 0.05, 
    'Бузок рожевий': 0.6, 
    'Гладіолус осінній': 0.08, 
    'Суниця садова': 0.01, 
    'Малина жовта': 0.15, 
    'Агрус червоний': 0.2, 
    'Глід білий': 0.35, 
    'Сирень блакитна': 0.5, 
    'Трава польова': 0.1, 
    'Пшениця садова': 0.08, 
    'Райграс декоративний': 0.07, 
    'Конюшина рожева': 0.05, 
    'Півонія біла': 0.25, 
    'Нарцис блакитний': 0.1, 
    'Калина жовта': 0.4, 
    'Груша садова': 0.7, 
    'Абрикос ранній': 0.8, 
    'Вишня солодка': 0.6, 
    'Слива весняна': 0.7, 
    'Чорниця великоплідна': 0.15, 
    'Груша паркова': 0.9, 
    'Тис золотистий': 0.5, 
    'Форзиція рання': 0.3, 
    'Ялівець сріблястий': 0.4, 
    'Мох лісовий': 0.02, 
    'Тимофіївка полівна': 0.1, 
    'Курильський чай червоний': 0.2, 
    'Бузок жовтий': 0.4, 
    'Орхідея полівна': 0.02, 
    'Флокс ранній': 0.03, 
    'Жовтець весняний': 0.08, 
    'Роза паркова': 0.5, 
    'Яблуня зимова': 0.5, 
    'Тюльпан пізній': 0.1, 
    'Сосна гірська': 0.6, 
    'Барвінок синій': 0.05, 
    'Лаванда дикий': 0.05, 
    'Шавлія червона': 0.05, 
    'Лілія жовта': 0.12, 
    'Ромашка полівна': 0.02, 
    'Малина золота': 0.15, 
    'Фіалка рання': 0.02, 
    'Груша південна': 0.7, 
    'Абрикос північний': 0.8, 
    'Вишня дика': 0.6
}

connection = sqlite3.connect('db.sqlite3')
cursor = connection.cursor()

#cursor.execute(f"ALTER TABLE 'content_plant' ADD COLUMN 'weight' decimal")

for value in prices.items():
    #print(value[1], value[0])
    cursor.execute(f"UPDATE content_plant SET weight = ? WHERE plant_name = ?", (value[1], value[0]))
    connection.commit()

#print(fetch_data_as_dict('db.sqlite3', 'content_plant', 'plant_name', 'weight'))

connection.close()
